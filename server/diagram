<svg viewBox="0 0 900 580" xmlns="http://www.w3.org/2000/svg" style="background:#0a0a0f">
  <defs>
    <linearGradient id="cyan" x1="0%" y1="0%" x2="100%" y2="0%">
      <stop offset="0%" stop-color="#00b8f2" stop-opacity="0.9"/>
      <stop offset="100%" stop-color="#0073a0" stop-opacity="0.7"/>
    </linearGradient>
    <linearGradient id="teal" x1="0%" y1="0%" x2="100%" y2="0%">
      <stop offset="0%" stop-color="#00af6e"/>
      <stop offset="100%" stop-color="#007a4d"/>
    </linearGradient>
    <linearGradient id="purple" x1="0%" y1="0%" x2="100%" y2="0%">
      <stop offset="0%" stop-color="#a855f7" stop-opacity="0.85"/>
      <stop offset="100%" stop-color="#7c3aed" stop-opacity="0.7"/>
    </linearGradient>
    <linearGradient id="rose" x1="0%" y1="0%" x2="100%" y2="0%">
      <stop offset="0%" stop-color="#f43f5e" stop-opacity="0.85"/>
      <stop offset="100%" stop-color="#be123c" stop-opacity="0.7"/>
    </linearGradient>
    <marker id="arrow" viewBox="0 0 10 10" refX="9" refY="5" markerWidth="6" markerHeight="6" orient="auto-start-reverse">
      <path d="M 0 0 L 10 5 L 0 10 z" fill="#3a3a4a"/>
    </marker>
    <marker id="arrowCyan" viewBox="0 0 10 10" refX="9" refY="5" markerWidth="6" markerHeight="6" orient="auto-start-reverse">
      <path d="M 0 0 L 10 5 L 0 10 z" fill="#00b8f2"/>
    </marker>
    <marker id="arrowTeal" viewBox="0 0 10 10" refX="9" refY="5" markerWidth="6" markerHeight="6" orient="auto-start-reverse">
      <path d="M 0 0 L 10 5 L 0 10 z" fill="#00af6e"/>
    </marker>
  </defs>

  <!-- Title -->
  <text x="450" y="38" text-anchor="middle" font-family="system-ui, sans-serif" font-size="20" font-weight="600" fill="#ffffff">Bloom — Agentic Pipeline Architecture</text>

  <!-- ════════════════════════════════════════ -->
  <!-- iOS App (left) -->
  <!-- ════════════════════════════════════════ -->
  <rect x="30" y="70" width="160" height="440" rx="14" fill="#12121a" stroke="#1e1e2e" stroke-width="1.5"/>
  <text x="110" y="96" text-anchor="middle" font-family="system-ui" font-size="13" font-weight="600" fill="#00b8f2">iOS App</text>

  <!-- Tab pills -->
  <rect x="48" y="115" width="124" height="28" rx="6" fill="#1a1a26" stroke="#2a2a3e" stroke-width="1"/>
  <text x="110" y="134" text-anchor="middle" font-family="system-ui" font-size="11" fill="#aaa">Mind · Body · Baby · Partner</text>

  <!-- User actions -->
  <rect x="48" y="160" width="124" height="56" rx="8" fill="#161620" stroke="#2a2a3e" stroke-width="1"/>
  <text x="110" y="180" text-anchor="middle" font-family="system-ui" font-size="11" fill="#ccc">User types message</text>
  <text x="110" y="198" text-anchor="middle" font-family="system-ui" font-size="10" fill="#666">or uploads photo</text>

  <!-- Context box -->
  <rect x="48" y="234" width="124" height="70" rx="8" fill="#161620" stroke="#2a2a3e" stroke-width="1"/>
  <text x="110" y="254" text-anchor="middle" font-family="system-ui" font-size="11" font-weight="500" fill="#00b8f2">Context Payload</text>
  <text x="110" y="272" text-anchor="middle" font-family="system-ui" font-size="9.5" fill="#666">mood_history</text>
  <text x="110" y="285" text-anchor="middle" font-family="system-ui" font-size="9.5" fill="#666">baby_data · recovery_stage</text>
  <text x="110" y="298" text-anchor="middle" font-family="system-ui" font-size="9.5" fill="#666">delivery_type · user_role</text>

  <!-- SSE listener -->
  <rect x="48" y="322" width="124" height="44" rx="8" fill="#161620" stroke="#2a2a3e" stroke-width="1"/>
  <text x="110" y="340" text-anchor="middle" font-family="system-ui" font-size="11" fill="#ccc">SSE Listener</text>
  <text x="110" y="355" text-anchor="middle" font-family="system-ui" font-size="9.5" fill="#666">streams events in</text>

  <!-- BloomService -->
  <rect x="48" y="384" width="124" height="32" rx="6" fill="#1a2030" stroke="#00b8f2" stroke-width="1" stroke-opacity="0.4"/>
  <text x="110" y="405" text-anchor="middle" font-family="system-ui" font-size="11" font-weight="500" fill="#00b8f2">BloomService</text>

  <!-- ════════════════════════════════════════ -->
  <!-- Arrow: iOS → Server -->
  <!-- ════════════════════════════════════════ -->
  <line x1="192" y1="250" x2="280" y2="250" stroke="#00b8f2" stroke-width="2" marker-end="url(#arrowCyan)" opacity="0.7"/>
  <text x="236" y="243" text-anchor="middle" font-family="system-ui" font-size="9.5" fill="#00b8f2">POST /bloom</text>

  <!-- Arrow: SSE back -->
  <line x1="280" y1="340" x2="192" y2="340" stroke="#00af6e" stroke-width="2" marker-end="url(#arrowTeal)" opacity="0.7"/>
  <text x="236" y="333" text-anchor="middle" font-family="system-ui" font-size="9.5" fill="#00af6e">SSE events</text>

  <!-- ════════════════════════════════════════ -->
  <!-- Server.py -->
  <!-- ════════════════════════════════════════ -->
  <rect x="280" y="200" width="120" height="80" rx="10" fill="#14141f" stroke="#3a3a5a" stroke-width="1.5"/>
  <text x="340" y="232" text-anchor="middle" font-family="system-ui" font-size="13" font-weight="600" fill="#fff">server.py</text>
  <text x="340" y="252" text-anchor="middle" font-family="system-ui" font-size="9.5" fill="#666">Flask · CORS</text>
  <text x="340" y="266" text-anchor="middle" font-family="system-ui" font-size="9.5" fill="#666">HTTP only</text>

  <!-- Arrow: server → pipeline -->
  <line x1="400" y1="240" x2="450" y2="240" stroke="#3a3a4a" stroke-width="2" marker-end="url(#arrow)"/>

  <!-- ════════════════════════════════════════ -->
  <!-- Pipeline.py (orchestrator) -->
  <!-- ════════════════════════════════════════ -->
  <rect x="450" y="175" width="150" height="130" rx="12" fill="#1a1520" stroke="#a855f7" stroke-width="1.5" stroke-opacity="0.5"/>
  <text x="525" y="200" text-anchor="middle" font-family="system-ui" font-size="13" font-weight="600" fill="#a855f7">pipeline.py</text>
  <text x="525" y="220" text-anchor="middle" font-family="system-ui" font-size="10" fill="#888">Orchestrator</text>
  <text x="525" y="240" text-anchor="middle" font-family="system-ui" font-size="9.5" fill="#666">1. Build context</text>
  <text x="525" y="255" text-anchor="middle" font-family="system-ui" font-size="9.5" fill="#666">2. Run Router</text>
  <text x="525" y="270" text-anchor="middle" font-family="system-ui" font-size="9.5" fill="#666">3. Run Specialist</text>
  <text x="525" y="285" text-anchor="middle" font-family="system-ui" font-size="9.5" fill="#666">4. Yield SSE</text>

  <!-- ════════════════════════════════════════ -->
  <!-- Context.py (shared state) -->
  <!-- ════════════════════════════════════════ -->
  <rect x="450" y="330" width="150" height="50" rx="8" fill="#161620" stroke="#3a3a5a" stroke-width="1"/>
  <text x="525" y="350" text-anchor="middle" font-family="system-ui" font-size="12" font-weight="500" fill="#fff">context.py</text>
  <text x="525" y="368" text-anchor="middle" font-family="system-ui" font-size="9.5" fill="#666">Shared state · travels through pipeline</text>

  <!-- Arrow pipeline ↔ context -->
  <line x1="525" y1="305" x2="525" y2="330" stroke="#3a3a4a" stroke-width="1.5" marker-end="url(#arrow)"/>

  <!-- ════════════════════════════════════════ -->
  <!-- Router Agent -->
  <!-- ════════════════════════════════════════ -->
  <rect x="650" y="100" width="220" height="60" rx="10" fill="#1a1520" stroke="#a855f7" stroke-width="1.2" stroke-opacity="0.6"/>
  <text x="760" y="123" text-anchor="middle" font-family="system-ui" font-size="12" font-weight="600" fill="#a855f7">RouterAgent</text>
  <text x="760" y="143" text-anchor="middle" font-family="system-ui" font-size="9.5" fill="#666">Picks pillar + action from 16 tasks</text>

  <!-- Arrow pipeline → router -->
  <line x1="600" y1="195" x2="760" y2="160" stroke="#a855f7" stroke-width="1.5" stroke-opacity="0.6" marker-end="url(#arrow)"/>

  <!-- Arrow router → gemini -->
  <line x1="760" y1="160" x2="760" y2="195" stroke="#3a3a4a" stroke-width="1.2" marker-end="url(#arrow)"/>

  <!-- Gemini badge (top) -->
  <rect x="700" y="195" width="120" height="30" rx="6" fill="#1e1520" stroke="#a855f7" stroke-width="0.8" stroke-opacity="0.4"/>
  <text x="760" y="215" text-anchor="middle" font-family="system-ui" font-size="10" fill="#a855f7">Gemini Flash</text>

  <!-- ════════════════════════════════════════ -->
  <!-- Tasks.py -->
  <!-- ════════════════════════════════════════ -->
  <rect x="650" y="250" width="220" height="40" rx="8" fill="#161620" stroke="#3a3a5a" stroke-width="1"/>
  <text x="760" y="268" text-anchor="middle" font-family="system-ui" font-size="11" font-weight="500" fill="#fff">tasks.py</text>
  <text x="760" y="283" text-anchor="middle" font-family="system-ui" font-size="9.5" fill="#666">16 tasks · registry lookup</text>

  <!-- Arrow pipeline → tasks -->
  <line x1="600" y1="260" x2="650" y2="270" stroke="#3a3a4a" stroke-width="1.2" marker-end="url(#arrow)"/>

  <!-- ════════════════════════════════════════ -->
  <!-- Specialist Agents (4 boxes) -->
  <!-- ════════════════════════════════════════ -->

  <!-- Mind -->
  <rect x="650" y="320" width="100" height="48" rx="8" fill="#1a1520" stroke="#a855f7" stroke-width="1" stroke-opacity="0.5"/>
  <text x="700" y="340" text-anchor="middle" font-family="system-ui" font-size="11" font-weight="600" fill="#c084fc">Mind</text>
  <text x="700" y="358" text-anchor="middle" font-family="system-ui" font-size="9" fill="#666">mood · breathing</text>

  <!-- Body -->
  <rect x="760" y="320" width="100" height="48" rx="8" fill="#1a1520" stroke="#f43f5e" stroke-width="1" stroke-opacity="0.5"/>
  <text x="810" y="340" text-anchor="middle" font-family="system-ui" font-size="11" font-weight="600" fill="#fb7185">Body</text>
  <text x="810" y="358" text-anchor="middle" font-family="system-ui" font-size="9" fill="#666">recovery · photo</text>

  <!-- Baby -->
  <rect x="650" y="386" width="100" height="48" rx="8" fill="#1a1520" stroke="#00af6e" stroke-width="1" stroke-opacity="0.5"/>
  <text x="700" y="406" text-anchor="middle" font-family="system-ui" font-size="11" font-weight="600" fill="#34d399">Baby</text>
  <text x="700" y="424" text-anchor="middle" font-family="system-ui" font-size="9" fill="#666">cues · feeding</text>

  <!-- Partner -->
  <rect x="760" y="386" width="100" height="48" rx="8" fill="#1a1520" stroke="#00b8f2" stroke-width="1" stroke-opacity="0.5"/>
  <text x="810" y="406" text-anchor="middle" font-family="system-ui" font-size="11" font-weight="600" fill="#38bdf8">Partner</text>
  <text x="810" y="424" text-anchor="middle" font-family="system-ui" font-size="9" fill="#666">help · context</text>

  <!-- Arrows: pipeline → specialists (one dashed line fans out) -->
  <line x1="600" y1="290" x2="640" y2="344" stroke="#3a3a4a" stroke-width="1.2" stroke-dasharray="4 3" marker-end="url(#arrow)"/>
  <line x1="600" y1="290" x2="750" y2="344" stroke="#3a3a4a" stroke-width="1.2" stroke-dasharray="4 3" marker-end="url(#arrow)"/>
  <line x1="600" y1="290" x2="640" y2="410" stroke="#3a3a4a" stroke-width="1.2" stroke-dasharray="4 3" marker-end="url(#arrow)"/>
  <line x1="600" y1="290" x2="750" y2="410" stroke="#3a3a4a" stroke-width="1.2" stroke-dasharray="4 3" marker-end="url(#arrow)"/>
  <text x="618" y="310" font-family="system-ui" font-size="9" fill="#666">one runs</text>

  <!-- ════════════════════════════════════════ -->
  <!-- Prompts layer (bottom) -->
  <!-- ════════════════════════════════════════ -->
  <rect x="650" y="455" width="210" height="100" rx="10" fill="#111118" stroke="#2a2a3e" stroke-width="1"/>
  <text x="755" y="478" text-anchor="middle" font-family="system-ui" font-size="11" font-weight="500" fill="#888">prompts/</text>
  <text x="690" y="500" text-anchor="middle" font-family="system-ui" font-size="10" fill="#c084fc">router.py</text>
  <text x="740" y="500" text-anchor="middle" font-family="system-ui" font-size="10" fill="#fb7185">body.py</text>
  <text x="790" y="500" text-anchor="middle" font-family="system-ui" font-size="10" fill="#34d399">baby.py</text>
  <text x="690" y="525" text-anchor="middle" font-family="system-ui" font-size="10" fill="#c084fc">mind.py</text>
  <text x="760" y="525" text-anchor="middle" font-family="system-ui" font-size="10" fill="#38bdf8">partner.py</text>

  <!-- Arrows: agents → prompts -->
  <line x1="700" y1="368" x2="700" y2="455" stroke="#2a2a3e" stroke-width="1" marker-end="url(#arrow)"/>
  <line x1="810" y1="368" x2="780" y2="455" stroke="#2a2a3e" stroke-width="1" marker-end="url(#arrow)"/>
  <line x1="700" y1="434" x2="700" y2="455" stroke="#2a2a3e" stroke-width="1" marker-end="url(#arrow)"/>
  <line x1="810" y1="434" x2="790" y2="455" stroke="#2a2a3e" stroke-width="1" marker-end="url(#arrow)"/>

  <!-- ════════════════════════════════════════ -->
  <!-- Gemini badge (bottom, shared by specialists) -->
  <!-- ════════════════════════════════════════ -->
  <rect x="450" y="400" width="120" height="30" rx="6" fill="#1e1520" stroke="#a855f7" stroke-width="0.8" stroke-opacity="0.4"/>
  <text x="510" y="420" text-anchor="middle" font-family="system-ui" font-size="10" fill="#a855f7">Gemini Flash</text>

  <!-- Arrow specialist → gemini -->
  <line x1="650" y1="410" x2="570" y2="415" stroke="#2a2a3e" stroke-width="1" marker-end="url(#arrow)"/>

  <!-- ════════════════════════════════════════ -->
  <!-- gemini_client.py label -->
  <!-- ════════════════════════════════════════ -->
  <text x="510" y="450" text-anchor="middle" font-family="system-ui" font-size="9" fill="#555">gemini_client.py</text>

  <!-- ════════════════════════════════════════ -->
  <!-- Legend -->
  <!-- ════════════════════════════════════════ -->
  <line x1="30" y1="540" x2="55" y2="540" stroke="#00b8f2" stroke-width="2"/>
  <text x="60" y="544" font-family="system-ui" font-size="9.5" fill="#666">HTTP / SSE</text>
  <line x1="130" y1="540" x2="155" y2="540" stroke="#a855f7" stroke-width="1.5" stroke-opacity="0.6"/>
  <text x="160" y="544" font-family="system-ui" font-size="9.5" fill="#666">Orchestration</text>
  <line x1="250" y1="540" x2="275" y2="540" stroke="#3a3a4a" stroke-width="1.2" stroke-dasharray="4 3"/>
  <text x="280" y="544" font-family="system-ui" font-size="9.5" fill="#666">Dynamic dispatch (one agent runs)</text>
</svg>